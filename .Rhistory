facet_wrap(~parent_pop)+
scale_colour_gradientn(                         # low=blue, high=red
colours = c("#2c7bb6","#abd9e9","#ffffbf","#fdae61","#d7191c"),
name = "solar radiation (W/m²)")+
geom_point(alpha=0.25,size=0.5)+
geom_line(alpha=0.5) +
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
scale_y_continuous(
name = "Height (cm)")+
labs(title = "Figure F: Time-Height",
x = "Survey Date",
y = "Height (cm)") +
theme_bw()
library(tidyverse)
library(readxl)
library(lubridate)
library(janitor)
library(purrr)
library(readr)
library(ggthemes)
library(ggeffects)
library(lme4)
library(dplyr)
library(ggplot2)
#install.packages("emmeans")
library(emmeans)
#install.packages("broom.mixed")
library(broom.mixed)
library(viridis)
library(nlme)
library(mgcv)
#setwd("C:/Users/Tobyz/Desktop/S.tort-light-growth/Data")
plant_with_light%>%
ggplot(aes(survey_date, height_cm, colour = weekly_avg_SlrW, group=PID)) +
facet_wrap(~parent_pop)+
scale_colour_gradientn(                         # low=blue, high=red
colours = c("#2c7bb6","#abd9e9","#ffffbf","#fdae61","#d7191c"),
name = "solar radiation (W/m²)")+
geom_point(alpha=0.25,size=0.5)+
geom_line(alpha=0.5) +
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
scale_y_continuous(
name = "Height (cm)")+
labs(title = "Figure F: Time-Height",
x = "Survey Date",
y = "Height (cm)") +
theme_bw()
plant_with_light%>%
select(parent_pop="TM2")
plant_with_light%>%
select(parent_pop=="TM2")
plant_with_light%>%
filter(parent_pop=="TM2")
ggplot(aes(survey_date, height_cm, colour = weekly_avg_SlrW, group=PID)) +
scale_colour_gradientn(                         # low=blue, high=red
colours = c("#2c7bb6","#abd9e9","#ffffbf","#fdae61","#d7191c"),
name = "Solar Radiation (W/m²)")+
geom_point(alpha=0.25,size=0.5)+
geom_line(alpha=0.5) +
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
scale_y_continuous(
name = "Height (cm)")+
labs(title = "Figure F: Time-Height",
x = "Survey Date",
y = "Height (cm)") +
theme_bw()
plant_with_light%>%
filter(parent_pop=="TM2")%>%
ggplot(aes(survey_date, height_cm, colour = weekly_avg_SlrW, group=PID)) +
scale_colour_gradientn(                         # low=blue, high=red
colours = c("#2c7bb6","#abd9e9","#ffffbf","#fdae61","#d7191c"),
name = "Solar Radiation (W/m²)")+
geom_point(alpha=0.25,size=0.5)+
geom_line(alpha=0.5) +
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
scale_y_continuous(
name = "Height (cm)")+
labs(title = "Figure F: Time-Height",
x = "Survey Date",
y = "Height (cm)") +
theme_bw()
plant_with_light%>%
filter(parent_pop=="TM2")%>%
ggplot(aes(survey_date, height_cm, colour = weekly_avg_SlrW, group=PID)) +
scale_colour_gradientn(                         # low=blue, high=red
colours = c("#2c7bb6","#abd9e9","#ffffbf","#fdae61","#d7191c"),
name = "Solar Radiation (W/m²)")+
geom_point(alpha=0.25,size=0.5)+
geom_line(alpha=1) +
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
scale_y_continuous(
name = "Height (cm)")+
labs(title = "Figure F: Time-Height",
x = "Survey Date",
y = "Height (cm)") +
theme_bw()
plant_with_light%>%
filter(parent_pop=="TM2")%>%
ggplot(aes(survey_date, height_cm, colour = weekly_avg_SlrW, group=PID)) +
scale_colour_gradientn(                         # low=blue, high=red
colours = c("#2c7bb6","#abd9e9","#ffffbf","#fdae61","#d7191c"),
name = "Solar Radiation (W/m²)")+
geom_point(alpha=1,size=0.5)+
geom_line(alpha=1) +
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
scale_y_continuous(
name = "Height (cm)")+
labs(title = "Figure F: Time-Height",
x = "Survey Date",
y = "Height (cm)") +
theme_bw()
plant_with_light%>%
filter(parent_pop=="CP3")%>%
ggplot(aes(survey_date, height_cm, colour = weekly_avg_SlrW, group=PID)) +
scale_colour_gradientn(                         # low=blue, high=red
colours = c("#2c7bb6","#abd9e9","#ffffbf","#fdae61","#d7191c"),
name = "Solar Radiation (W/m²)")+
geom_point(alpha=1,size=0.5)+
geom_line(alpha=1) +
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
scale_y_continuous(
name = "Height (cm)")+
labs(title = "Figure F: Time-Height",
x = "Survey Date",
y = "Height (cm)") +
theme_bw()
plant_with_light%>%
filter(parent_pop=="FR")%>%
ggplot(aes(survey_date, height_cm, colour = weekly_avg_SlrW, group=PID)) +
scale_colour_gradientn(                         # low=blue, high=red
colours = c("#2c7bb6","#abd9e9","#ffffbf","#fdae61","#d7191c"),
name = "Solar Radiation (W/m²)")+
geom_point(alpha=1,size=0.5)+
geom_line(alpha=1) +
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
scale_y_continuous(
name = "Height (cm)")+
labs(title = "Figure F: Time-Height",
x = "Survey Date",
y = "Height (cm)") +
theme_bw()
View(pl_lt)
knitr::opts_chunk$set(echo = TRUE)
#tinytex::tlmgr_install("ctex")
pl_lt%>%
ggplot(aes(survey_date, height, colour = mean_light_ly_day, group=pop)) +
facet_wrap(~pop)+
scale_colour_gradientn(                         # low=blue, high=red
colours = c("#2c7bb6","#abd9e9","#ffffbf","#fdae61","#d7191c"),
name = "solar radiation (W/m²)")+
geom_point(alpha=0.25,size=0.5)+
geom_line(alpha=0.5) +
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
scale_y_continuous(
name = "Height (cm)")+
labs(title = "Figure F.1: Time-Height",
x = "Survey Date",
y = "Height (cm)") +
theme_bw()
pl_lt%>%
ggplot(aes(survey_date, height, colour = mean_light_ly_day, group=pop)) +
facet_wrap(~pop)+
scale_colour_gradientn(                         # low=blue, high=red
colours = c("#2c7bb6","#abd9e9","#ffffbf","#fdae61","#d7191c"),
name = "solar radiation (W/m²)")+
geom_point(alpha=0.25,size=0.5)+
geom_line(alpha=0.5) +
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
scale_y_continuous(
name = "Height (cm)")+
labs(title = "Figure F.1: Time-Height",
x = "Survey Date",
y = "Height (cm)") +
guides(x = guide_axis(n.dodge = 2))
theme_bw()
pl_lt%>%
ggplot(aes(survey_date, height, colour = mean_light_ly_day, group=pop)) +
facet_wrap(~pop)+
scale_colour_gradientn(                         # low=blue, high=red
colours = c("#2c7bb6","#abd9e9","#ffffbf","#fdae61","#d7191c"),
name = "solar radiation (W/m²)")+
geom_point(alpha=0.25,size=0.5)+
geom_line(alpha=0.5) +
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
scale_y_continuous(
name = "Height (cm)")+
labs(title = "Figure F.1: Time-Height",
x = "Survey Date",
y = "Height (cm)") +
theme(axis.text.x = element_text(angle=45))
theme_bw()
pl_lt%>%
ggplot(aes(survey_date, height, colour = mean_light_ly_day, group=pop)) +
facet_wrap(~pop)+
scale_colour_gradientn(                         # low=blue, high=red
colours = c("#2c7bb6","#abd9e9","#ffffbf","#fdae61","#d7191c"),
name = "solar radiation (W/m²)")+
geom_point(alpha=0.25,size=0.5)+
geom_line(alpha=0.5) +
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
scale_y_continuous(
name = "Height (cm)")+
labs(title = "Figure F.1: Time-Height",
x = "Survey Date",
y = "Height (cm)") +
guides(x = guide_axis(n.dodge = 2))+
theme(axis.text.x = element_text(angle=45))+
theme_bw()
pl_lt%>%
ggplot(aes(survey_date, height, colour = mean_light_ly_day, group=pop)) +
facet_wrap(~pop)+
scale_colour_gradientn(                         # low=blue, high=red
colours = c("#2c7bb6","#abd9e9","#ffffbf","#fdae61","#d7191c"),
name = "solar radiation (W/m²)")+
geom_point(alpha=0.25,size=0.5)+
geom_line(alpha=0.5) +
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
scale_y_continuous(
name = "Height (cm)")+
labs(title = "Figure F.1: Time-Height",
x = "Survey Date",
y = "Height (cm)") +
#  guides(x = guide_axis(n.dodge = 2))+
theme(axis.text.x = element_text(angle=30))+
theme_bw()
pl_lt%>%
ggplot(aes(survey_date, height, colour = mean_light_ly_day, group=pop)) +
facet_wrap(~pop)+
scale_colour_gradientn(                         # low=blue, high=red
colours = c("#2c7bb6","#abd9e9","#ffffbf","#fdae61","#d7191c"),
name = "solar radiation (W/m²)")+
geom_point(alpha=0.25,size=0.5)+
geom_line(alpha=0.5) +
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
scale_y_continuous(
name = "Height (cm)")+
labs(title = "Figure F.1: Time-Height",
x = "Survey Date",
y = "Height (cm)") +
#  guides(x = guide_axis(n.dodge = 2))+
theme_bw()+
theme(axis.text.x = element_text(angle=30))
pl_lt%>%
ggplot(aes(survey_date, height, colour = mean_light_ly_day, group=pop)) +
facet_wrap(~pop)+
scale_colour_gradientn(                         # low=blue, high=red
colours = c("#2c7bb6","#abd9e9","#ffffbf","#fdae61","#d7191c"),
name = "solar radiation (W/m²)")+
geom_point(alpha=0.25,size=0.5)+
geom_line(alpha=0.5) +
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
scale_y_continuous(
name = "Height (cm)")+
labs(title = "Figure F.1: Time-Height",
x = "Survey Date",
y = "Height (cm)") +
guides(x = guide_axis(n.dodge = 2))+
theme_bw()+
theme(axis.text.x = element_text(angle=30))
pl_lt%>%
filter(pop=="TM2")%>%
ggplot(aes(survey_date, height, colour = mean_light_ly_day, group=pop)) +
scale_colour_gradientn(                         # low=blue, high=red
colours = c("#2c7bb6","#abd9e9","#ffffbf","#fdae61","#d7191c"),
name = "Solar Radiation (W/m²)")+
geom_point(alpha=1,size=0.5)+
geom_line(alpha=1) +
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
scale_y_continuous(
name = "Height (cm)")+
labs(title = "Figure F.2: Time-Height for TM2",
x = "Survey Date",
y = "Height (cm)") +
theme_bw()
pl_lt%>%
ggplot(aes(survey_date, height, colour = mean_light_ly_day, group=PID)) +
facet_wrap(~pop)+
scale_colour_gradientn(                         # low=blue, high=red
colours = c("#2c7bb6","#abd9e9","#ffffbf","#fdae61","#d7191c"),
name = "Solar Radiation (W/m²)")+
geom_point(alpha=0.25,size=0.5)+
geom_line(alpha=0.5) +
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
scale_y_continuous(
name = "Height (cm)")+
labs(title = "Figure F.1: Time-Height",
x = "Survey Date",
y = "Height (cm)") +
guides(x = guide_axis(n.dodge = 2))+
theme_bw()+
theme(axis.text.x = element_text(angle=30))
pl_lt%>%
filter(pop=="TM2")%>%
ggplot(aes(survey_date, height, colour = mean_light_ly_day, group=PID)) +
scale_colour_gradientn(                         # low=blue, high=red
colours = c("#2c7bb6","#abd9e9","#ffffbf","#fdae61","#d7191c"),
name = "Solar Radiation (W/m²)")+
geom_point(alpha=1,size=0.5)+
geom_line(alpha=1) +
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
scale_y_continuous(
name = "Height (cm)")+
labs(title = "Figure F.2: Time-Height for TM2",
x = "Survey Date",
y = "Height (cm)") +
theme_bw()
pl_lt%>%
filter(pop=="BH")%>%
ggplot(aes(survey_date, height, colour = mean_light_ly_day, group=PID)) +
scale_colour_gradientn(                         # low=blue, high=red
colours = c("#2c7bb6","#abd9e9","#ffffbf","#fdae61","#d7191c"),
name = "Solar Radiation (W/m²)")+
geom_point(alpha=1,size=0.5)+
geom_line(alpha=1) +
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
scale_y_continuous(
name = "Height (cm)")+
labs(title = "Figure F.3: Time-Height for BH",
x = "Survey Date",
y = "Height (cm)") +
theme_bw()
pl_lt%>%
filter(pop=="DPR")%>%
ggplot(aes(survey_date, height, colour = mean_light_ly_day, group=PID)) +
scale_colour_gradientn(                         # low=blue, high=red
colours = c("#2c7bb6","#abd9e9","#ffffbf","#fdae61","#d7191c"),
name = "Solar Radiation (W/m²)")+
geom_point(alpha=1,size=0.5)+
geom_line(alpha=1) +
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
scale_y_continuous(
name = "Height (cm)")+
labs(title = "Figure F.4: Time-Height for DPR",
x = "Survey Date",
y = "Height (cm)") +
theme_bw()
#tinytex::tlmgr_install("ctex")
tinytex::tlmgr_update(self = TRUE)     # 更新 tlmgr 本身
system2(tinytex::tlmgr_path(), args = c("fmtutil-sys", "--all"))
#tinytex::tlmgr_install("ctex")
#tinytex::tlmgr_update(self = TRUE)     # 更新 tlmgr 本身
#tinytex::tlmgr_update(all  = TRUE)     # 更新所有 LaTeX 包
tinytex::tlmgr_install(c("latex-bin", "l3kernel", "l3packages", "l3backend"))
knitr::opts_chunk$set(echo = TRUE)
#tinytex::tlmgr_install("ctex")
#tinytex::tlmgr_update(self = TRUE)     # 更新 tlmgr 本身
#tinytex::tlmgr_update(all  = TRUE)     # 更新所有 LaTeX 包
#tinytex::tlmgr_install(c("latex-bin", "l3kernel", "l3packages", "l3backend"))
#system2(tinytex::tlmgr_path(), args = c("fmtutil-sys", "--all"))
write.csv(pl_lt, "Data/pl_lt", row.names=FALSE)
knitr::opts_chunk$set(echo = TRUE)
pl_lt <- read.csv("Data/pl_lt.csv")
pl_lt <- read.csv("Data/pl_lt.csv")
View(pl_lt)
View(pl_lt)
pl_lt <- read.csv("Data/pl_lt.csv")
pl_lt <- pl_lt %>%
arrange(survey_date) %>%
mutate(
week_index = as.integer((as.numeric(survey_date - min(survey_date)) %/% 7) + 1)
)
library(dplyr)
library(lubridate)
pl_lt <- read.csv("Data/pl_lt.csv")
pl_lt <- pl_lt %>%
arrange(survey_date) %>%
mutate(
week_index = as.integer((as.numeric(survey_date - min(survey_date)) %/% 7) + 1)
)
pl_lt <- read.csv("Data/pl_lt.csv")%>% mutate(survey_date = as.Date(survey_date))
pl_lt <- pl_lt %>%
arrange(survey_date) %>%
mutate(
week_index = as.integer((as.numeric(survey_date - min(survey_date)) %/% 7) + 1)
)
View(pl_lt)
pl_lt <- read.csv("Data/pl_lt.csv")%>% mutate(survey_date = as.Date(survey_date))
pl_lt <- pl_lt %>%
arrange(survey_date) %>%
mutate(
week = as.integer((as.numeric(survey_date - min(survey_date)) %/% 7) + 1)
)
pl_lt <- read.csv("Data/pl_lt.csv")%>% mutate(survey_date = as.Date(survey_date))
pl_lt <- pl_lt %>%
arrange(survey_date) %>%
mutate(
week = as.integer((as.numeric(survey_date - min(survey_date)) %/% 7) + 1)
)
pl_lt_t.lmer <- lmer(
daily_growth ~ mean_light_ly_day2 + week + (1 + mean_light_ly_day2 + week | pop),
data = pl_lt, REML = TRUE
)
library(tidyverse)
library(readxl)
library(lubridate)
library(janitor)
library(purrr)
library(readr)
library(ggthemes)
library(ggeffects)
library(lme4)
library(dplyr)
library(ggplot2)
pl_lt <- read.csv("Data/pl_lt.csv")%>% mutate(survey_date = as.Date(survey_date))
pl_lt <- pl_lt %>%
arrange(survey_date) %>%
mutate(
week = as.integer((as.numeric(survey_date - min(survey_date)) %/% 7) + 1)
)
pl_lt_t.lmer <- lmer(
daily_growth ~ mean_light_ly_day2 + week + (1 + mean_light_ly_day2 + week | pop),
data = pl_lt, REML = TRUE
)
summary(pl_lt_t.lmer)
knitr::opts_chunk$set(echo = TRUE)
#Standardization
plant_with_light$weekly_avg_SlrW2 <- scale(plant_with_light$weekly_avg_SlrW, center = TRUE, scale = TRUE)
mean_light <- mean(plant_with_light$weekly_avg_SlrW, na.rm = TRUE)
sd_light   <- sd(plant_with_light$weekly_avg_SlrW, na.rm = TRUE)
#Change Data type
plant_with_light <- plant_with_light %>%
mutate(
parent_pop = factor(parent_pop),
PID        = factor(PID),
block      = factor(block)
)
write.csv(plant_with_light, "Data/plant_with_light", row.names=FALSE)
pl_lt <- read.csv("Data/plant_with_light.csv")%>% mutate(survey_date = as.Date(survey_date))
pl_lt <- read.csv("Data/plant_with_light.csv")%>% mutate(survey_date = as.Date(survey_date))
View(plant_with_light)
plant_with_light <- read.csv("Data/plant_with_light.csv")%>% mutate(survey_date = as.Date(survey_date))
plant_with_light <- plant_with_light %>%
arrange(survey_date) %>%
mutate(
week = as.integer((as.numeric(survey_date - min(survey_date)) %/% 7) + 1)
)
growth_light_time.lmer <- lmer(
daily_growth ~ weekly_avg_SlrW2 + week
(1 + weekly_avg_SlrW2 + week | parent_pop),
data = plant_with_light, REML = TRUE
)
View(plant_with_light)
plant_with_light <- read.csv("Data/plant_with_light.csv")%>% mutate(survey_date = as.Date(survey_date))
plant_with_light <- plant_with_light %>%
arrange(survey_date) %>%
mutate(
week = as.integer((as.numeric(survey_date - min(survey_date)) %/% 7) + 1)
)
growth_light_time.lmer <- lmer(
daily_growth ~ weekly_avg_SlrW2 + week + (1 + weekly_avg_SlrW2 + week | parent_pop),
data = plant_with_light, REML = TRUE
)
summary(growth_light_time.lmer)
plant_with_light <- read.csv("Data/plant_with_light.csv")%>% mutate(survey_date = as.Date(survey_date))
plant_with_light <- plant_with_light %>%
arrange(survey_date) %>%
mutate(
week = as.integer((as.numeric(survey_date - min(survey_date)) %/% 7) + 1)
)
growth_light_time.lmer <- lmer(
daily_growth ~ weekly_avg_SlrW2 + week + (1 + weekly_avg_SlrW2 + week | parent_pop),
data = plant_with_light, REML = TRUE
)
summary(growth_light_time.lmer)
p_facet <- ggplot(pl_lt,
aes(mean_light_ly_day, daily_growth)) +
facet_wrap(~ pop, ncol = 6) +
geom_point(alpha = .15, size = .6, color = "grey35") +
geom_smooth(method = "lm", se = FALSE, linewidth = .8) +
labs(title = "Figure D: Light–Growth relationship by population",
x = "Daily Avg Light (ly/day)",
y = "Daily Growth (cm/day)") +
theme_bw() +
theme(strip.background = element_rect(fill = "grey95", color = NA),
strip.text = element_text(face = "bold"),
panel.grid.minor = element_blank())
p_facet
View(plant_growth_daily)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readxl)
library(lubridate)
library(janitor)
library(purrr)
library(readr)
library(ggthemes)
library(ggeffects)
library(lme4)
library(dplyr)
library(ggplot2)
pl_lt <- read.csv("Data/pl_lt.csv")%>% mutate(survey_date = as.Date(survey_date))
pl_lt <- pl_lt %>%
arrange(survey_date) %>%
mutate(
week = as.integer((as.numeric(survey_date - min(survey_date)) %/% 7) + 1)
)
pl_lt_t.lmer <- lmer(
daily_growth ~ mean_light_ly_day2 + week + (1 + mean_light_ly_day2 + week | pop),
data = pl_lt, REML = TRUE
)
summary  (pl_lt_t.lmer)
plant_with_light <- read.csv("Data/plant_with_light.csv")%>% mutate(survey_date = as.Date(survey_date))
plant_with_light <- plant_with_light %>%
arrange(survey_date) %>%
mutate(
week = as.integer((as.numeric(survey_date - min(survey_date)) %/% 7) + 1)
)
growth_light_time.lmer <- lmer(
daily_growth ~ weekly_avg_SlrW2 + week + (1 + weekly_avg_SlrW2 + week | parent_pop),
data = plant_with_light, REML = TRUE
)
summary(growth_light_time.lmer)
