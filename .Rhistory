knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readxl)
library(lubridate)
library(janitor)
library(purrr)
setwd("C:/Users/Tobyz/Desktop/S.tort-light-growth/Data")
files <- list.files(pattern = "WL2_size_survey.*\\.csv$")
safe_read_process <- safely(function(f) {
df <- read_csv(f, col_names = TRUE, show_col_types = FALSE) %>%
clean_names() %>%
mutate(
date = mdy(date),
bed_row = as.numeric(bed_row),
bed_col = as.character(bed_col),
height_cm = as.numeric(height_cm),
long_leaf_cm = if ("long_leaf_cm" %in% names(.)) as.numeric(as.character(long_leaf_cm)) else NA,
plant_id = paste(block, bed, bed_row, bed_col, sep = "_"),
source_file = f
)
return(df)
})
results <- map(files, safe_read_process)
successful_results <- keep(results, ~ !is.null(.x$result))
successful_data <- bind_rows(map(successful_results, "result"), .id = "source_index")
#import light data
light_raw <- read_csv("CR1000XSeries_IntBioHalfHourTable.txt", skip = 1, show_col_types = FALSE)
#import light data
light_raw <- read_csv("CR1000XSeries_IntBioHalfHourTable.txt", skip = 1, show_col_types = FALSE)
#import light data
light_raw <- read_csv("CR1000XSeries_IntBioHalfHourTable", skip = 1, show_col_types = FALSE)
#import light data
light_raw <- read_csv("CR1000XSeries_IntBioHalfHourTable.txt", skip = 1, show_col_types = FALSE)
library(tidyverse)
library(readxl)
library(lubridate)
library(janitor)
library(purrr)
setwd("C:/Users/Tobyz/Desktop/S.tort-light-growth/Data")
#import light data
light_raw <- read_csv("CR1000XSeries_IntBioHalfHourTable.txt", skip = 1, show_col_types = FALSE)
#import light data
light_raw <- read_csv("CR1000XSeries_IntBioHalfHourTable", skip = 1, show_col_types = FALSE)
#import light data
light_raw <- read_csv("CR1000XSeries_IntBioHalfHourTable.txt", skip = 1, show_col_types = FALSE)
#import light data
light_raw <- read_csv("CR1000XSeries_IntBioHalfHourTable.txt", skip = 1, show_col_types = FALSE)
files <- list.files(pattern = "WL2_size_survey.*\\.csv$")
safe_read_process <- safely(function(f) {
df <- read_csv(f, col_names = TRUE, show_col_types = FALSE) %>%
clean_names() %>%
mutate(
date = mdy(date),
bed_row = as.numeric(bed_row),
bed_col = as.character(bed_col),
height_cm = as.numeric(height_cm),
long_leaf_cm = if ("long_leaf_cm" %in% names(.)) as.numeric(as.character(long_leaf_cm)) else NA,
plant_id = paste(block, bed, bed_row, bed_col, sep = "_"),
source_file = f
)
return(df)
})
results <- map(files, safe_read_process)
successful_results <- keep(results, ~ !is.null(.x$result))
successful_data <- bind_rows(map(successful_results, "result"), .id = "source_index")
#import light data
light_raw <- read_csv("CR1000XSeries_IntBioHalfHourTable.txt", skip = 1, show_col_types = FALSE)
knitr::opts_chunk$set(echo = TRUE)
#import light data
light_raw <- read_csv("CR1000XSeries_IntBioHalfHourTable.txt", skip = 1, show_col_types = FALSE)
#weekly measurement
weekly_light <- light_raw %>%
mutate(
timestamp = ymd_hms(TIMESTAMP),
SlrW_Avg = as.numeric(SlrW_Avg),  # turn into number format
week = floor_date(timestamp, "week")
) %>%
group_by(week) %>%
summarise(
weekly_avg_SlrW = mean(SlrW_Avg, na.rm = TRUE),
.groups = "drop"
)
# result
print(weekly_light)
View(successful_results)
View(successful_data)
View(light_raw)
library(tidyverse)
library(readxl)
library(lubridate)
library(janitor)
library(purrr)
setwd("C:/Users/Tobyz/Desktop/S.tort-light-growth/Data")
files <- list.files(pattern = "WL2_size_survey.*\\.csv$")
safe_read_process <- safely(function(f) {
df <- read_csv(f, col_names = TRUE, show_col_types = FALSE) %>%
clean_names() %>%
mutate(
date = mdy(date),
bed_row = as.numeric(bed_row),
bed_col = as.character(bed_col),
height_cm = as.numeric(height_cm),
long_leaf_cm = if ("long_leaf_cm" %in% names(.)) as.numeric(as.character(long_leaf_cm)) else NA,
plant_id = paste(block, bed, bed_row, bed_col, sep = "_"),
source_file = f
)
return(df)
})
results <- map(files, safe_read_process)
successful_results <- keep(results, ~ !is.null(.x$result))
successful_data <- bind_rows(map(successful_results, "result"), .id = "source_index")
files <- list.files(pattern = "WL2_size_survey.*\\.csv$")
safe <- safely(function(f) {
df <- read_csv(f, col_names = TRUE, show_col_types = FALSE) %>%
clean_names() %>%
mutate(
date = mdy(date),
bed_row = as.numeric(bed_row),
bed_col = as.character(bed_col),
height_cm = as.numeric(height_cm),
long_leaf_cm = if ("long_leaf_cm" %in% names(.)) as.numeric(as.character(long_leaf_cm)) else NA,
plant_id = paste(block, bed, bed_row, bed_col, sep = "_"),
source_file = f
)
return(df)
})
results <- map(files, safe_read_process)
successful_results <- keep(results, ~ !is.null(.x$result))
successful_data <- bind_rows(map(successful_results, "result"), .id = "source_index")
