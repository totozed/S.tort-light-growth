geom_line(data = light_daily,
aes(survey_date, light_scaled, group = parent_pop),
colour = "black", linewidth = 0.9, alpha = 0.7) +
facet_wrap(~ parent_pop, ncol = 3) +  # 面板更大：每行 3 个
scale_colour_gradientn(
colours = c("#2c7bb6","#abd9e9","#ffffbf","#fdae61","#d7191c"), # 低蓝→高红
name = "光照强度 (W/m²)"
) +
labs(title = "Figure F: Time-Height",
x = "Survey Date",
y = "Height (cm)") +
theme_bw(base_size = 14) +  # 放大整体字体
theme(
strip.text = element_text(face = "bold", size = 12),
panel.grid.minor = element_blank()
) +
guides(colour = guide_colorbar(barheight = unit(120, "pt")))
# 计算每个 parent_pop 的高度范围，用来把光照缩放到高度轴
range_df <- plant_with_light %>%
filter(!is.na(height_cm)) %>%
group_by(parent_pop) %>%
summarise(hmin = min(height_cm, na.rm = TRUE),
hmax = max(height_cm, na.rm = TRUE),
.groups = "drop")
# 每个 parent_pop × 日期 的平均光照，并缩放到该 panel 的高度范围
light_daily <- plant_with_light %>%
filter(!is.na(survey_date), !is.na(weekly_avg_SlrW)) %>%
group_by(parent_pop, survey_date) %>%
summarise(light = mean(weekly_avg_SlrW, na.rm = TRUE), .groups = "drop") %>%
left_join(range_df, by = "parent_pop") %>%
group_by(parent_pop) %>%
mutate(light_scaled = scales::rescale(light, to = c(first(hmin), first(hmax)))) %>%
ungroup()
# 主数据（点）
df_plot <- plant_with_light %>%
filter(!is.na(survey_date), !is.na(height_cm), !is.na(weekly_avg_SlrW))
# 画图：点=高度（颜色=光照强度），线=光照（已缩放）
ggplot() +
geom_point(data = df_plot,
aes(survey_date, height_cm, colour = weekly_avg_SlrW),
alpha = 0.5, size = 0.6) +
geom_line(data = light_daily,
aes(survey_date, light_scaled, group = parent_pop),
colour = "black", linewidth = 0.9, alpha = 0.7) +
facet_wrap(~ parent_pop, ncol = 3) +  # 面板更大：每行 3 个
scale_colour_gradientn(
colours = c("#2c7bb6","#abd9e9","#ffffbf","#fdae61","#d7191c"), # 低蓝→高红
name = "光照强度 (W/m²)"
) +
labs(title = "Figure F: Time-Height",
x = "Survey Date",
y = "Height (cm)") +
theme_bw() +  # 放大整体字体
theme(
strip.text = element_text(face = "bold", size = 12),
panel.grid.minor = element_blank()
) +
guides(colour = guide_colorbar(barheight = unit(120, "pt")))
# 计算每个 parent_pop 的高度范围，用来把光照缩放到高度轴
range_df <- plant_with_light %>%
filter(!is.na(height_cm)) %>%
group_by(parent_pop) %>%
summarise(hmin = min(height_cm, na.rm = TRUE),
hmax = max(height_cm, na.rm = TRUE),
.groups = "drop")
# 每个 parent_pop × 日期 的平均光照，并缩放到该 panel 的高度范围
light_daily <- plant_with_light %>%
filter(!is.na(survey_date), !is.na(weekly_avg_SlrW)) %>%
group_by(parent_pop, survey_date) %>%
summarise(light = mean(weekly_avg_SlrW, na.rm = TRUE), .groups = "drop") %>%
left_join(range_df, by = "parent_pop") %>%
group_by(parent_pop) %>%
mutate(light_scaled = scales::rescale(light, to = c(first(hmin), first(hmax)))) %>%
ungroup()
# 主数据（点）
df_plot <- plant_with_light %>%
filter(!is.na(survey_date), !is.na(height_cm), !is.na(weekly_avg_SlrW))
# 画图：点=高度（颜色=光照强度），线=光照（已缩放）
ggplot() +
geom_point(data = df_plot,
aes(survey_date, height_cm, colour = weekly_avg_SlrW),
alpha = 0.5, size = 0.6) +
geom_line(data = light_daily,
aes(survey_date, light_scaled, group = parent_pop),
colour = "black", linewidth = 0.9, alpha = 0.7) +
facet_wrap(~ parent_pop, ncol = 3) +  # 面板更大：每行 3 个
scale_colour_gradientn(
colours = c("#2c7bb6","#abd9e9","#ffffbf","#fdae61","#d7191c"), # 低蓝→高红
name = "solar radiation (W/m²)"
) +
labs(title = "Figure F: Time-Height",
x = "Survey Date",
y = "Height (cm)") +
theme_bw() +  # 放大整体字体
guides(colour = guide_colorbar(barheight = unit(120, "pt")))
# 基础数据
df_plot <- plant_with_light %>%
filter(!is.na(survey_date), !is.na(height_cm), !is.na(weekly_avg_SlrW))
# 全局范围（用于 sec_axis 的一致变换）
y_rng     <- range(df_plot$height_cm, na.rm = TRUE)
light_rng <- range(df_plot$weekly_avg_SlrW, na.rm = TRUE)
# 每个 parent_pop × 日期 的平均光照，并把光照映射到高度轴（全局统一）
light_daily <- df_plot %>%
group_by(parent_pop, survey_date) %>%
summarise(light = mean(weekly_avg_SlrW, na.rm = TRUE), .groups = "drop") %>%
mutate(light_y = scales::rescale(light, to = y_rng, from = light_rng))
# 画图
ggplot() +
# 高度散点：颜色=光照强度
geom_point(data = df_plot,
aes(x = survey_date, y = height_cm, colour = weekly_avg_SlrW),
alpha = 0.45, size = 0.7) +
# 光照折线（已映射到高度轴）
geom_line(data = light_daily,
aes(x = survey_date, y = light_y, group = parent_pop),
colour = "black", linewidth = 0.9, alpha = 0.8) +
facet_wrap(~ parent_pop, ncol = 3) +           # 调小每行数量 → 面板更大
scale_colour_gradientn(                         # 低=蓝，高=红
colours = c("#2c7bb6","#abd9e9","#ffffbf","#fdae61","#d7191c"),
name = "solar radiation (W/m²)"
) +
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
scale_y_continuous(
name = "Height (cm)",
sec.axis = sec_axis(~ scales::rescale(., from = y_rng, to = light_rng),
name = "Solar radiation (W/m²)")
) +
labs(title = "Figure F: Time–Height",
x = "Survey Date") +
theme_bw(base_size = 14) +
theme(
strip.text = element_text(face = "bold", size = 12),
panel.grid.minor = element_blank()
)
# 基础数据
df_plot <- plant_with_light %>%
filter(!is.na(survey_date), !is.na(height_cm), !is.na(weekly_avg_SlrW))
# 全局范围（用于 sec_axis 的一致变换）
y_rng     <- range(df_plot$height_cm, na.rm = TRUE)
light_rng <- range(df_plot$weekly_avg_SlrW, na.rm = TRUE)
# 每个 parent_pop × 日期 的平均光照，并把光照映射到高度轴（全局统一）
light_daily <- df_plot %>%
group_by(parent_pop, survey_date) %>%
summarise(light = mean(weekly_avg_SlrW, na.rm = TRUE), .groups = "drop") %>%
mutate(light_y = scales::rescale(light, to = y_rng, from = light_rng))
# 画图
ggplot() +
# 高度散点：颜色=光照强度
geom_point(data = df_plot,
aes(x = survey_date, y = height_cm, colour = weekly_avg_SlrW),
alpha = 0.45, size = 0.7) +
# 光照折线（已映射到高度轴）
geom_line(data = light_daily,
aes(x = survey_date, y = light_y, group = parent_pop),
colour = "black", linewidth = 0.9, alpha = 0.8) +
facet_wrap(~ parent_pop, ncol = 3) +           # 调小每行数量 → 面板更大
scale_colour_gradientn(                         # 低=蓝，高=红
colours = c("#2c7bb6","#abd9e9","#ffffbf","#fdae61","#d7191c"),
name = "solar radiation (W/m²)"
) +
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
scale_y_continuous(
name = "Height (cm)",
sec.axis = sec_axis(~ scales::rescale(., from = y_rng, to = light_rng),
name = "Solar radiation (W/m²)")
) +
labs(title = "Figure F: Time–Height",
x = "Survey Date") +
theme_bw(base_size = 6) +
theme(
strip.text = element_text(face = "bold", size = 12),
panel.grid.minor = element_blank()
)
# 基础数据
df_plot <- plant_with_light %>%
filter(!is.na(survey_date), !is.na(height_cm), !is.na(weekly_avg_SlrW))
# 全局范围（用于 sec_axis 的一致变换）
y_rng     <- range(df_plot$height_cm, na.rm = TRUE)
light_rng <- range(df_plot$weekly_avg_SlrW, na.rm = TRUE)
# 每个 parent_pop × 日期 的平均光照，并把光照映射到高度轴（全局统一）
light_daily <- df_plot %>%
group_by(parent_pop, survey_date) %>%
summarise(light = mean(weekly_avg_SlrW, na.rm = TRUE), .groups = "drop") %>%
mutate(light_y = scales::rescale(light, to = y_rng, from = light_rng))
# 画图
ggplot() +
# 高度散点：颜色=光照强度
geom_point(data = df_plot,
aes(x = survey_date, y = height_cm, colour = weekly_avg_SlrW),
alpha = 0.45, size = 0.7) +
# 光照折线（已映射到高度轴）
geom_line(data = light_daily,
aes(x = survey_date, y = light_y, group = parent_pop),
colour = "black", linewidth = 0.9, alpha = 0.8) +
facet_wrap(~ parent_pop, ncol = 3) +           # 调小每行数量 → 面板更大
scale_colour_gradientn(                         # 低=蓝，高=红
colours = c("#2c7bb6","#abd9e9","#ffffbf","#fdae61","#d7191c"),
name = "solar radiation (W/m²)"
) +
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
scale_y_continuous(
name = "Height (cm)",
sec.axis = sec_axis(~ scales::rescale(., from = y_rng, to = light_rng),
name = "Solar radiation (W/m²)")
) +
labs(title = "Figure F: Time–Height",
x = "Survey Date") +
theme_bw(base_size = 6) +
theme(
strip.text = element_text(face = "bold", size = 6),
panel.grid.minor = element_blank()
)
# 基础数据
df_plot <- plant_with_light %>%
filter(!is.na(survey_date), !is.na(height_cm), !is.na(weekly_avg_SlrW))
# 全局范围（用于 sec_axis 的一致变换）
y_rng     <- range(df_plot$height_cm, na.rm = TRUE)
light_rng <- range(df_plot$weekly_avg_SlrW, na.rm = TRUE)
# 每个 parent_pop × 日期 的平均光照，并把光照映射到高度轴（全局统一）
light_daily <- df_plot %>%
group_by(parent_pop, survey_date) %>%
summarise(light = mean(weekly_avg_SlrW, na.rm = TRUE), .groups = "drop") %>%
mutate(light_y = scales::rescale(light, to = y_rng, from = light_rng))
# 画图
ggplot() +
# 高度散点：颜色=光照强度
geom_point(data = df_plot,
aes(x = survey_date, y = height_cm, colour = weekly_avg_SlrW),
alpha = 0.45, size = 0.7) +
# 光照折线（已映射到高度轴）
geom_line(data = light_daily,
aes(x = survey_date, y = light_y, group = parent_pop),
colour = "black", linewidth = 0.9, alpha = 0.8) +
facet_wrap(~ parent_pop, ncol = 3) +           # 调小每行数量 → 面板更大
scale_colour_gradientn(                         # 低=蓝，高=红
colours = c("#2c7bb6","#abd9e9","#ffffbf","#fdae61","#d7191c"),
name = "solar radiation (W/m²)"
) +
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
scale_y_continuous(
name = "Height (cm)",
sec.axis = sec_axis(~ scales::rescale(., from = y_rng, to = light_rng),
name = "Solar radiation (W/m²)")
) +
labs(title = "Figure F: Time–Height",
x = "Survey Date") +
theme_bw(base_size = 9) +
theme(
strip.text = element_text(face = "bold", size = 8),
panel.grid.minor = element_blank()
)
# 基础数据
df_plot <- plant_with_light %>%
filter(!is.na(survey_date), !is.na(height_cm), !is.na(weekly_avg_SlrW))
# 全局范围（用于 sec_axis 的一致变换）
y_rng     <- range(df_plot$height_cm, na.rm = TRUE)
light_rng <- range(df_plot$weekly_avg_SlrW, na.rm = TRUE)
# 每个 parent_pop × 日期 的平均光照，并把光照映射到高度轴（全局统一）
light_daily <- df_plot %>%
group_by(parent_pop, survey_date) %>%
summarise(light = mean(weekly_avg_SlrW, na.rm = TRUE), .groups = "drop") %>%
mutate(light_y = scales::rescale(light, to = y_rng, from = light_rng))
# 画图
ggplot() +
# 高度散点：颜色=光照强度
geom_point(data = df_plot,
aes(x = survey_date, y = height_cm, colour = weekly_avg_SlrW),
alpha = 0.45, size = 0.7) +
# 光照折线（已映射到高度轴）
geom_line(data = light_daily,
aes(x = survey_date, y = light_y, group = parent_pop),
colour = "black", linewidth = 0.5, alpha = 0.5) +
facet_wrap(~ parent_pop, ncol = 3) +           # 调小每行数量 → 面板更大
scale_colour_gradientn(                         # 低=蓝，高=红
colours = c("#2c7bb6","#abd9e9","#ffffbf","#fdae61","#d7191c"),
name = "solar radiation (W/m²)"
) +
scale_x_date(date_breaks = "1 week", date_labels = "%b") +
scale_y_continuous(
name = "Height (cm)",
sec.axis = sec_axis(~ scales::rescale(., from = y_rng, to = light_rng),
name = "Solar radiation (W/m²)")
) +
labs(title = "Figure F: Time–Height",
x = "Survey Date") +
theme_bw()
)
# 基础数据
df_plot <- plant_with_light %>%
filter(!is.na(survey_date), !is.na(height_cm), !is.na(weekly_avg_SlrW))
# 全局范围（用于 sec_axis 的一致变换）
y_rng     <- range(df_plot$height_cm, na.rm = TRUE)
light_rng <- range(df_plot$weekly_avg_SlrW, na.rm = TRUE)
# 每个 parent_pop × 日期 的平均光照，并把光照映射到高度轴（全局统一）
light_daily <- df_plot %>%
group_by(parent_pop, survey_date) %>%
summarise(light = mean(weekly_avg_SlrW, na.rm = TRUE), .groups = "drop") %>%
mutate(light_y = scales::rescale(light, to = y_rng, from = light_rng))
# 画图
ggplot() +
# 高度散点：颜色=光照强度
geom_point(data = df_plot,
aes(x = survey_date, y = height_cm, colour = weekly_avg_SlrW),
alpha = 0.45, size = 0.7) +
# 光照折线（已映射到高度轴）
geom_line(data = light_daily,
aes(x = survey_date, y = light_y, group = parent_pop),
colour = "black", linewidth = 0.5, alpha = 0.5) +
facet_wrap(~ parent_pop, ncol = 3) +           # 调小每行数量 → 面板更大
scale_colour_gradientn(                         # 低=蓝，高=红
colours = c("#2c7bb6","#abd9e9","#ffffbf","#fdae61","#d7191c"),
name = "solar radiation (W/m²)"
) +
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
scale_y_continuous(
name = "Height (cm)",
sec.axis = sec_axis(~ scales::rescale(., from = y_rng, to = light_rng),
name = "Solar radiation (W/m²)")
) +
labs(title = "Figure F: Time–Height",
x = "Survey Date") +
theme_bw()
)
plant_with_light%>%
group_by(parent_pop)%>%
ggplot(aes(survey_date, height_cm, colour = weekly_avg_SlrW)) +
facet_wrap(~parent_pop)+
scale_colour_gradientn(                         # 低=蓝，高=红
colours = c("#2c7bb6","#abd9e9","#ffffbf","#fdae61","#d7191c"),
name = "solar radiation (W/m²)")+
geom_line(alpha=0.5, size=1) +
labs(title = "Figure F: Time-Height",
x = "Survey Date",
y = "Height (cm)") +
theme_bw()
plant_with_light%>%
group_by(parent_pop)%>%
ggplot(aes(survey_date, height_cm, colour = weekly_avg_SlrW)) +
facet_wrap(~parent_pop)+
scale_colour_gradientn(                         # 低=蓝，高=红
colours = c("#2c7bb6","#abd9e9","#ffffbf","#fdae61","#d7191c"),
name = "solar radiation (W/m²)")+
geom_point()
geom_line(alpha=0.5, size=1) +
labs(title = "Figure F: Time-Height",
x = "Survey Date",
y = "Height (cm)") +
theme_bw()
plant_with_light%>%
group_by(parent_pop)%>%
ggplot(aes(survey_date, height_cm, colour = weekly_avg_SlrW)) +
facet_wrap(~parent_pop)+
scale_colour_gradientn(                         # 低=蓝，高=红
colours = c("#2c7bb6","#abd9e9","#ffffbf","#fdae61","#d7191c"),
name = "solar radiation (W/m²)")+
geom_point()+
geom_line(alpha=0.5, size=1) +
labs(title = "Figure F: Time-Height",
x = "Survey Date",
y = "Height (cm)") +
theme_bw()
plant_with_light%>%
group_by(parent_pop)%>%
ggplot(aes(survey_date, height_cm, colour = weekly_avg_SlrW)) +
facet_wrap(~parent_pop)+
scale_colour_gradientn(                         # 低=蓝，高=红
colours = c("#2c7bb6","#abd9e9","#ffffbf","#fdae61","#d7191c"),
name = "solar radiation (W/m²)")+
geom_point(alpha=0.5,size=0.5)+
geom_line(alpha=0.5, size=1) +
labs(title = "Figure F: Time-Height",
x = "Survey Date",
y = "Height (cm)") +
theme_bw()
View(light_raw)
# 光照原始表 light_raw: 包含 TIMESTAMP 和 SlrW_Avg
light_daily <- light_raw %>%
mutate(date = as.Date(TIMESTAMP)) %>%
group_by(date) %>%
summarise(SlrW_mean = mean(SlrW_Avg, na.rm = TRUE), .groups = "drop")
# 你的植株数据
df_plot <- plant_with_light %>%
filter(!is.na(survey_date), !is.na(height_cm), !is.na(weekly_avg_SlrW))
# 全局范围（用于 sec_axis 的一致变换）
y_rng     <- range(df_plot$height_cm, na.rm = TRUE)
light_rng <- range(light_daily$SlrW_mean, na.rm = TRUE)
# 把光照平均缩放到高度的 y 轴范围
light_daily <- light_daily %>%
mutate(light_y = scales::rescale(SlrW_mean, to = y_rng, from = light_rng))
plant_with_light%>%
group_by(parent_pop)%>%
ggplot(aes(survey_date, height_cm, colour = weekly_avg_SlrW)) +
geom_line(data = light_daily,
aes(x = date, y = light_y),
colour = "black", linewidth = 1) +
facet_wrap(~parent_pop)+
scale_colour_gradientn(                         # 低=蓝，高=红
colours = c("#2c7bb6","#abd9e9","#ffffbf","#fdae61","#d7191c"),
name = "solar radiation (W/m²)")+
geom_point(alpha=0.5,size=0.5)+
geom_line(alpha=0.5, size=1) +
labs(title = "Figure F: Time-Height",
x = "Survey Date",
y = "Height (cm)") +
theme_bw()
# 光照原始表 light_raw: 包含 TIMESTAMP 和 SlrW_Avg
light_daily <- light_raw %>%
mutate(date = as.Date(TIMESTAMP)) %>%
group_by(date) %>%
summarise(SlrW_mean = mean(SlrW_Avg, na.rm = TRUE), .groups = "drop")
# 你的植株数据
df_plot <- plant_with_light %>%
filter(!is.na(survey_date), !is.na(height_cm), !is.na(weekly_avg_SlrW))
# 全局范围（用于 sec_axis 的一致变换）
y_rng     <- range(df_plot$height_cm, na.rm = TRUE)
light_rng <- range(light_daily$SlrW_mean, na.rm = TRUE)
# 把光照平均缩放到高度的 y 轴范围
light_daily <- light_daily %>%
mutate(light_y = scales::rescale(SlrW_mean, to = y_rng, from = light_rng))
plant_with_light%>%
group_by(parent_pop)%>%
ggplot(aes(survey_date, height_cm, colour = weekly_avg_SlrW)) +
geom_line(data = light_daily,
aes(x = date, y = light_y),
colour = "black", linewidth = 1) +
facet_wrap(~parent_pop)+
scale_colour_gradientn(                         # 低=蓝，高=红
colours = c("#2c7bb6","#abd9e9","#ffffbf","#fdae61","#d7191c"),
name = "solar radiation (W/m²)")+
geom_point(alpha=0.5,size=0.5)+
geom_line(alpha=0.5, size=1) +
scale_y_continuous(
name = "Height (cm)",
sec.axis = sec_axis(~ scales::rescale(., from = y_rng, to = light_rng),
name = "Daily mean solar radiation (W/m²)"))+
labs(title = "Figure F: Time-Height",
x = "Survey Date",
y = "Height (cm)") +
theme_bw()
plant_with_light%>%
group_by(parent_pop)%>%
ggplot(aes(survey_date, height_cm, colour = weekly_avg_SlrW)) +
geom_line(data = light_daily,
aes(x = date, y = light_y),
colour = "black", linewidth = 1) +
facet_wrap(~parent_pop)+
scale_colour_gradientn(                         # 低=蓝，高=红
colours = c("#2c7bb6","#abd9e9","#ffffbf","#fdae61","#d7191c"),
name = "solar radiation (W/m²)")+
geom_point(alpha=0.5,size=0.5)+
geom_line(alpha=0.5, size=1) +
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
scale_y_continuous(
name = "Height (cm)",
sec.axis = sec_axis(~ scales::rescale(., from = y_rng, to = light_rng),
name = "Daily mean solar radiation (W/m²)"))+
labs(title = "Figure F: Time-Height",
x = "Survey Date",
y = "Height (cm)") +
theme_bw()
light_daily <- light_raw %>%
mutate(date = as.Date(TIMESTAMP)) %>%
group_by(date) %>%
summarise(SlrW_mean = mean(SlrW_Avg, na.rm = TRUE), .groups = "drop")
df_plot <- plant_with_light %>%
filter(!is.na(survey_date), !is.na(height_cm), !is.na(weekly_avg_SlrW))
y_rng     <- range(df_plot$height_cm, na.rm = TRUE)
light_rng <- range(light_daily$SlrW_mean, na.rm = TRUE)
light_daily <- light_daily %>%
mutate(light_y = scales::rescale(SlrW_mean, to = y_rng, from = light_rng))
plant_with_light%>%
group_by(parent_pop)%>%
ggplot(aes(survey_date, height_cm, colour = weekly_avg_SlrW)) +
geom_line(data = light_daily,
aes(x = date, y = light_y),
colour = "black", linewidth = 0.5, alpha= 0.25) +
facet_wrap(~parent_pop)+
scale_colour_gradientn(                         # 低=蓝，高=红
colours = c("#2c7bb6","#abd9e9","#ffffbf","#fdae61","#d7191c"),
name = "solar radiation (W/m²)")+
geom_point(alpha=0.5,size=0.5)+
geom_line(alpha=0.5, size=1) +
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
scale_y_continuous(
name = "Height (cm)",
sec.axis = sec_axis(~ scales::rescale(., from = y_rng, to = light_rng),
name = "Solar Radiation (W/m²)"))+
labs(title = "Figure F: Time-Height",
x = "Survey Date",
y = "Height (cm)") +
theme_bw()
plant_with_light%>%
group_by(parent_pop)%>%
ggplot(aes(survey_date, height_cm, colour = weekly_avg_SlrW)) +
geom_line(data = light_daily,
aes(x = date, y = light_y),
colour = "black", linewidth = 0.5, alpha= 0.25) +
facet_wrap(~parent_pop)+
scale_colour_gradientn(                         # 低=蓝，高=红
colours = c("#2c7bb6","#abd9e9","#ffffbf","#fdae61","#d7191c"),
name = "solar radiation (W/m²)")+
geom_point(alpha=0.25,size=0.5)+
geom_line(alpha=1, size=1) +
scale_x_date(date_breaks = "1 month", date_labels = "%b") +
scale_y_continuous(
name = "Height (cm)",
sec.axis = sec_axis(~ scales::rescale(., from = y_rng, to = light_rng),
name = "Solar Radiation (W/m²)"))+
labs(title = "Figure F: Time-Height",
x = "Survey Date",
y = "Height (cm)") +
theme_bw()
